function cosineMat = quat2cosineMat(q)
    e1 =[q(1) ^ 2 + q(2) ^ 2 - q(3) ^ 2 - q(4) ^ 2;
         2 * (q(1) * q(4) + q(2) * q(3));
         2 * (q(2) * q(4) - q(1) * q(3))];

    e2 =[2 * (q(2) * q(3) - q(1) * q(4));
         q(1) ^ 2 - q(2) ^ 2 + q(3) ^ 2 - q(4) ^ 2;
         2 * (q(1) * q(2) + q(3) * q(4))];

    e3 =[2 * (q(2) * q(3) + q(2) * q(4));
         2 * (q(3) * q(4) - q(1) * q(2));
         q(1) ^ 2 - q(2) ^ 2 - q(3) ^ 2 + q(4) ^ 2];
    
    cosineMat = [e1, e2, e3];
end